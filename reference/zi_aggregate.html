<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Aggregate ZCTAs to Three-digit ZCTAs — zi_aggregate • zippeR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Aggregate ZCTAs to Three-digit ZCTAs — zi_aggregate"><meta name="description" content="This function takes input ZCTA data and aggregates it to three-digit
   areas, which are considerably larger. These regions are sometimes used in
   American health care contexts for publishing geographic identifiers."><meta property="og:description" content="This function takes input ZCTA data and aggregates it to three-digit
   areas, which are considerably larger. These regions are sometimes used in
   American health care contexts for publishing geographic identifiers."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">zippeR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/basics.html">Basics of ZIP Codes and ZCTAs</a></li>
    <li><a class="dropdown-item" href="../articles/converting-zips.html">Converting ZIP Codes to Other Geographies</a></li>
    <li><a class="dropdown-item" href="../articles/demographic-geometric-zcta-data.html">Demographic and Geometric ZCTA Data</a></li>
    <li><a class="dropdown-item" href="../articles/three-digit-zips.html">Three-digit ZIP Codes and ZCTAs</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pfizer-opensource/zippeR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Aggregate ZCTAs to Three-digit ZCTAs</h1>
      <small class="dont-index">Source: <a href="https://github.com/pfizer-opensource/zippeR/blob/main/R/zi_aggregate.R" class="external-link"><code>R/zi_aggregate.R</code></a></small>
      <div class="d-none name"><code>zi_aggregate.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function takes input ZCTA data and aggregates it to three-digit
   areas, which are considerably larger. These regions are sometimes used in
   American health care contexts for publishing geographic identifiers.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">zi_aggregate</span><span class="op">(</span><span class="va">.data</span>, <span class="va">year</span>, extensive <span class="op">=</span> <span class="cn">NULL</span>, intensive <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    intensive_method <span class="op">=</span> <span class="st">"mean"</span>, <span class="va">survey</span>, output <span class="op">=</span> <span class="st">"tidy"</span>, zcta <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    key <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg--data">.data<a class="anchor" aria-label="anchor" href="#arg--data"></a></dt>
<dd><p>A tidy set of demographic data containing one or more variables
that should be aggregated to three-digit ZCTAs. This data frame or tibble
should contain all five-digit ZCTAs within the three digit ZCTAs that you
plan to use for aggregating data. See Details below for formatting
requirements.</p></dd>


<dt id="arg-year">year<a class="anchor" aria-label="anchor" href="#arg-year"></a></dt>
<dd><p>A four-digit numeric scalar for year. <code>zippeR</code> currently
supports data for from 2010 to 2022. Different <code>survey</code> products
are available for different years. See the <code>survey</code> parameter
for more details.</p></dd>


<dt id="arg-extensive">extensive<a class="anchor" aria-label="anchor" href="#arg-extensive"></a></dt>
<dd><p>A character scalar or vector listing all extensive (i.e.
count data) variables you wish to aggregate. These will be summed. For
American Community Survey data, the margin of error will be calculated by
taking the square root of the summed, squared margins of error for each
five-digit ZCTA within a given three-digit ZCTA.</p></dd>


<dt id="arg-intensive">intensive<a class="anchor" aria-label="anchor" href="#arg-intensive"></a></dt>
<dd><p>A character scalar or vector listing all intensive (i.e.
ratio, percent, or median data) variables you wish to aggregate. These
will be combined using the approach listed for <code>intensive_method</code>.</p></dd>


<dt id="arg-intensive-method">intensive_method<a class="anchor" aria-label="anchor" href="#arg-intensive-method"></a></dt>
<dd><p>A character scalar; either <code>"mean"</code> (default)
or <code>"median"</code>. In either case, a weighted approach is used where
total population for each five-digit ZCTA is used to calculate individual
ZCTAs' weights. For American Community Survey Data, this is applied to
the margin of error as well.</p></dd>


<dt id="arg-survey">survey<a class="anchor" aria-label="anchor" href="#arg-survey"></a></dt>
<dd><p>A character scalar representing the Census product. It can
be either a Decennial Census product (either <code>"sf1"</code> or <code>"sf3"</code>)
or an American Community Survey product (either <code>"acs1"</code>,
<code>"acs3"</code>, or <code>"acs5"</code>). For Decennial Census calls, only the 2010
Census is available. In addition, if a variable cannot be found in <code>"sf1"</code>,
the function will look in <code>"sf3"</code>. Also note that <code>"acs3"</code> was
discontinued after 2013.</p></dd>


<dt id="arg-output">output<a class="anchor" aria-label="anchor" href="#arg-output"></a></dt>
<dd><p>A character scalar; one of <code>"tidy"</code> (long output) or
<code>"wide"</code> depending on the type of data format you want. If you are
planning to join these data with geometric data, <code>"wide"</code> is the
strongly encouraged format.</p></dd>


<dt id="arg-zcta">zcta<a class="anchor" aria-label="anchor" href="#arg-zcta"></a></dt>
<dd><p>An optional vector of ZCTAs that demographic data are requested
for. If this is <code>NULL</code>, data will be returned for all ZCTAs. If a
vector is supplied, only data for those requested ZCTAs will be returned.
The vector can be created with <code><a href="zi_get_geometry.html">zi_get_geometry()</a></code>. If
<code>style = "zcta5"</code>, this vector should be made up of five-digit
<code>GEOID</code> values. If <code>style = "zcta3"</code>, this vector should be
made up of three-digital <code>ZCTA3</code> values.</p></dd>


<dt id="arg-key">key<a class="anchor" aria-label="anchor" href="#arg-key"></a></dt>
<dd><p>A Census API key, which can be obtained at
<a href="https://api.census.gov/data/key_signup.html" class="external-link">https://api.census.gov/data/key_signup.html</a>. This can be omitted if
<code><a href="https://walker-data.com/tidycensus/reference/census_api_key.html" class="external-link">tidycensus::census_api_key()</a></code> has been used to write your key to
your <code>.Renviron</code> file. You can check whether an API key has been
written to <code>.Renviron</code> by using <code>Sys.getenv("CENSUS_API_KEY")</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A tibble containing all aggregated data requested in either
    <code>"tidy"</code> or <code>"wide"</code> format.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># load sample demographic data</span></span></span>
<span class="r-in"><span><span class="va">mo22_demos</span> <span class="op">&lt;-</span> <span class="va">zi_mo_pop</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># the above data can be replicated with the following code:</span></span></span>
<span class="r-in"><span>  <span class="co"># zi_get_demographics(year = 2022, variables = c("B01003_001", "B19013_001"),</span></span></span>
<span class="r-in"><span>  <span class="co">#   survey = "acs5")</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># load sample geometric data</span></span></span>
<span class="r-in"><span><span class="va">mo22_zcta3</span> <span class="op">&lt;-</span> <span class="va">zi_mo_zcta3</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># the above data can be replicated with the following code:</span></span></span>
<span class="r-in"><span>  <span class="co"># zi_get_geometry(year = 2022, style = "zcta3", state = "MO",</span></span></span>
<span class="r-in"><span>  <span class="co">#   method = "intersect")</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># aggregate a single variable</span></span></span>
<span class="r-in"><span><span class="fu">zi_aggregate</span><span class="op">(</span><span class="va">mo22_demos</span>, year <span class="op">=</span> <span class="fl">2020</span>, extensive <span class="op">=</span> <span class="st">"B01003_001"</span>, survey <span class="op">=</span> <span class="st">"acs5"</span>,</span></span>
<span class="r-in"><span>  zcta <span class="op">=</span> <span class="va">mo22_zcta3</span><span class="op">$</span><span class="va">ZCTA3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 62 × 4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># Groups:   ZCTA3 [31]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    ZCTA3 variable   estimate     moe</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> 501   B01003_001   <span style="text-decoration: underline;">190</span>606   <span style="text-decoration: underline;">1</span>928.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> 501   B19013_001  4<span style="text-decoration: underline;">927</span>943 <span style="text-decoration: underline;">224</span>587.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> 516   B01003_001    <span style="text-decoration: underline;">22</span>779    649.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> 516   B19013_001  1<span style="text-decoration: underline;">326</span>659 <span style="text-decoration: underline;">128</span>553.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> 525   B01003_001   <span style="text-decoration: underline;">109</span>992   <span style="text-decoration: underline;">1</span>607.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> 525   B19013_001  2<span style="text-decoration: underline;">965</span>635 <span style="text-decoration: underline;">153</span>947.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> 526   B01003_001   <span style="text-decoration: underline;">101</span>629   <span style="text-decoration: underline;">1</span>496.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> 526   B19013_001  2<span style="text-decoration: underline;">187</span>815 <span style="text-decoration: underline;">116</span>391.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> 620   B01003_001   <span style="text-decoration: underline;">296</span>331   <span style="text-decoration: underline;">2</span>842.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> 620   B19013_001  4<span style="text-decoration: underline;">623</span>927 <span style="text-decoration: underline;">163</span>752.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 52 more rows</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># aggregate multiple variables, outputting wide data</span></span></span>
<span class="r-in"><span><span class="fu">zi_aggregate</span><span class="op">(</span><span class="va">mo22_demos</span>, year <span class="op">=</span> <span class="fl">2020</span>,</span></span>
<span class="r-in"><span>  extensive <span class="op">=</span> <span class="st">"B01003_001"</span>, intensive <span class="op">=</span> <span class="st">"B19013_001"</span>, survey <span class="op">=</span> <span class="st">"acs5"</span>,</span></span>
<span class="r-in"><span>  zcta <span class="op">=</span> <span class="va">mo22_zcta3</span><span class="op">$</span><span class="va">ZCTA3</span>, output <span class="op">=</span> <span class="st">"wide"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 31 × 5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># Groups:   ZCTA3 [31]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    ZCTA3 B01003_001E B01003_001M B19013_001E B19013_001M</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> 501        <span style="text-decoration: underline;">190</span>606       <span style="text-decoration: underline;">1</span>928.      <span style="text-decoration: underline;">74</span>666.      <span style="text-decoration: underline;">19</span>684.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> 516         <span style="text-decoration: underline;">22</span>779        649.      <span style="text-decoration: underline;">69</span>824.      <span style="text-decoration: underline;">21</span>896.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> 525        <span style="text-decoration: underline;">109</span>992       <span style="text-decoration: underline;">1</span>607.      <span style="text-decoration: underline;">63</span>099.      <span style="text-decoration: underline;">17</span>528.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> 526        <span style="text-decoration: underline;">101</span>629       <span style="text-decoration: underline;">1</span>496.      <span style="text-decoration: underline;">70</span>575.      <span style="text-decoration: underline;">16</span>179.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> 620        <span style="text-decoration: underline;">296</span>331       <span style="text-decoration: underline;">2</span>842.      <span style="text-decoration: underline;">66</span>056.      <span style="text-decoration: underline;">16</span>494.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> 630        <span style="text-decoration: underline;">736</span>536       <span style="text-decoration: underline;">7</span>216.      <span style="text-decoration: underline;">84</span>735.      <span style="text-decoration: underline;">12</span>280.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> 631        <span style="text-decoration: underline;">901</span>642       <span style="text-decoration: underline;">8</span>313.      <span style="text-decoration: underline;">69</span>807.       <span style="text-decoration: underline;">9</span>031 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> 633        <span style="text-decoration: underline;">536</span>266       <span style="text-decoration: underline;">5</span>361.      <span style="text-decoration: underline;">78</span>343.      <span style="text-decoration: underline;">16</span>652 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> 634         <span style="text-decoration: underline;">67</span>129       <span style="text-decoration: underline;">1</span>583.      <span style="text-decoration: underline;">60</span>690.      <span style="text-decoration: underline;">21</span>671.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> 635         <span style="text-decoration: underline;">60</span>410       <span style="text-decoration: underline;">1</span>185.      <span style="text-decoration: underline;">54</span>968.      <span style="text-decoration: underline;">17</span>621.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 21 more rows</span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Christopher Prener, Timothy Wiemken, Angela Cook.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

