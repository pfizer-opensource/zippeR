<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Aggregate ZCTAs to Three-digit ZCTAs — zi_aggregate • zippeR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Aggregate ZCTAs to Three-digit ZCTAs — zi_aggregate"><meta property="og:description" content="This function takes input ZCTA data and aggregates it to three-digit
   areas, which are considerably larger. These regions are sometimes used in
   American health care contexts for publishing geographic identifiers."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">zippeR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/basics.html">Basics of ZIP Codes and ZCTAs</a>
    </li>
    <li>
      <a href="../articles/converting-zips.html">Converting ZIP Codes to Other Geographies</a>
    </li>
    <li>
      <a href="../articles/demographic-geometric-zcta-data.html">Demographic and Geometric ZCTA Data</a>
    </li>
    <li>
      <a href="../articles/three-digit-zips.html">Three-digit ZIP Codes and ZCTAs</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/pfizer-opensource/zippeR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Aggregate ZCTAs to Three-digit ZCTAs</h1>
    <small class="dont-index">Source: <a href="https://github.com/pfizer-opensource/zippeR/blob/main/R/zi_aggregate.R" class="external-link"><code>R/zi_aggregate.R</code></a></small>
    <div class="hidden name"><code>zi_aggregate.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function takes input ZCTA data and aggregates it to three-digit
   areas, which are considerably larger. These regions are sometimes used in
   American health care contexts for publishing geographic identifiers.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">zi_aggregate</span><span class="op">(</span><span class="va">.data</span>, <span class="va">year</span>, extensive <span class="op">=</span> <span class="cn">NULL</span>, intensive <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    intensive_method <span class="op">=</span> <span class="st">"mean"</span>, <span class="va">survey</span>, output <span class="op">=</span> <span class="st">"tidy"</span>, zcta <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    key <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg--data">.data<a class="anchor" aria-label="anchor" href="#arg--data"></a></dt>
<dd><p>A tidy set of demographic data containing one or more variables
that should be aggregated to three-digit ZCTAs. This data frame or tibble
should contain all five-digit ZCTAs within the three digit ZCTAs that you
plan to use for aggregating data. See Details below for formatting
requirements.</p></dd>


<dt id="arg-year">year<a class="anchor" aria-label="anchor" href="#arg-year"></a></dt>
<dd><p>A four-digit numeric scalar for year. <code>zippeR</code> currently
supports data for from 2010 to 2022. Different <code>survey</code> products
are available for different years. See the <code>survey</code> parameter
for more details.</p></dd>


<dt id="arg-extensive">extensive<a class="anchor" aria-label="anchor" href="#arg-extensive"></a></dt>
<dd><p>A character scalar or vector listing all extensive (i.e.
count data) variables you wish to aggregate. These will be summed. For
American Community Survey data, the margin of error will be calculated by
taking the square root of the summed, squared margins of error for each
five-digit ZCTA within a given three-digit ZCTA.</p></dd>


<dt id="arg-intensive">intensive<a class="anchor" aria-label="anchor" href="#arg-intensive"></a></dt>
<dd><p>A character scalar or vector listing all intensive (i.e.
ratio, percent, or median data) variables you wish to aggregate. These
will be combined using the approach listed for <code>intensive_method</code>.</p></dd>


<dt id="arg-intensive-method">intensive_method<a class="anchor" aria-label="anchor" href="#arg-intensive-method"></a></dt>
<dd><p>A character scalar; either <code>"mean"</code> (default)
or <code>"median"</code>. In either case, a weighted approach is used where
total population for each five-digit ZCTA is used to calculate individual
ZCTAs' weights. For American Community Survey Data, this is applied to
the margin of error as well.</p></dd>


<dt id="arg-survey">survey<a class="anchor" aria-label="anchor" href="#arg-survey"></a></dt>
<dd><p>A character scalar representing the Census product. It can
be either a Decennial Census product (either <code>"sf1"</code> or <code>"sf3"</code>)
or an American Community Survey product (either <code>"acs1"</code>,
<code>"acs3"</code>, or <code>"acs5"</code>). For Decennial Census calls, only the 2010
Census is available. In addition, if a variable cannot be found in <code>"sf1"</code>,
the function will look in <code>"sf3"</code>. Also note that <code>"acs3"</code> was
discontinued after 2013.</p></dd>


<dt id="arg-output">output<a class="anchor" aria-label="anchor" href="#arg-output"></a></dt>
<dd><p>A character scalar; one of <code>"tidy"</code> (long output) or
<code>"wide"</code> depending on the type of data format you want. If you are
planning to join these data with geometric data, <code>"wide"</code> is the
strongly encouraged format.</p></dd>


<dt id="arg-zcta">zcta<a class="anchor" aria-label="anchor" href="#arg-zcta"></a></dt>
<dd><p>An optional vector of ZCTAs that demographic data are requested
for. If this is <code>NULL</code>, data will be returned for all ZCTAs. If a
vector is supplied, only data for those requested ZCTAs will be returned.
The vector can be created with <code><a href="zi_get_geometry.html">zi_get_geometry()</a></code>. If
<code>style = "zcta5"</code>, this vector should be made up of five-digit
<code>GEOID</code> values. If <code>style = "zcta3"</code>, this vector should be
made up of three-digital <code>ZCTA3</code> values.</p></dd>


<dt id="arg-key">key<a class="anchor" aria-label="anchor" href="#arg-key"></a></dt>
<dd><p>A Census API key, which can be obtained at
<a href="https://api.census.gov/data/key_signup.html" class="external-link">https://api.census.gov/data/key_signup.html</a>. This can be omitted if
<code><a href="https://walker-data.com/tidycensus/reference/census_api_key.html" class="external-link">tidycensus::census_api_key()</a></code> has been used to write your key to
your <code>.Renviron</code> file. You can check whether an API key has been
written to <code>.Renviron</code> by using <code>Sys.getenv("CENSUS_API_KEY")</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A tibble containing all aggregated data requested in either
    <code>"tidy"</code> or <code>"wide"</code> format.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># load sample demographic data</span></span></span>
<span class="r-in"><span><span class="va">mo22_demos</span> <span class="op">&lt;-</span> <span class="va">zi_mo_pop</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># the above data can be replicated with the following code:</span></span></span>
<span class="r-in"><span>  <span class="co"># zi_get_demographics(year = 2022, variables = c("B01003_001", "B19013_001"),</span></span></span>
<span class="r-in"><span>  <span class="co">#   survey = "acs5")</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># load sample geometric data</span></span></span>
<span class="r-in"><span><span class="va">mo22_zcta3</span> <span class="op">&lt;-</span> <span class="va">zi_mo_zcta3</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># the above data can be replicated with the following code:</span></span></span>
<span class="r-in"><span>  <span class="co"># zi_get_geometry(year = 2022, style = "zcta3", state = "MO",</span></span></span>
<span class="r-in"><span>  <span class="co">#   method = "intersect")</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># aggregate a single variable</span></span></span>
<span class="r-in"><span><span class="fu">zi_aggregate</span><span class="op">(</span><span class="va">mo22_demos</span>, year <span class="op">=</span> <span class="fl">2020</span>, extensive <span class="op">=</span> <span class="st">"B01003_001"</span>, survey <span class="op">=</span> <span class="st">"acs5"</span>,</span></span>
<span class="r-in"><span>  zcta <span class="op">=</span> <span class="va">mo22_zcta3</span><span class="op">$</span><span class="va">ZCTA3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 62 × 4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># Groups:   ZCTA3 [31]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    ZCTA3 variable   estimate     moe</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> 501   B01003_001   <span style="text-decoration: underline;">190</span>606   <span style="text-decoration: underline;">1</span>928.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> 501   B19013_001  4<span style="text-decoration: underline;">927</span>943 <span style="text-decoration: underline;">224</span>587.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> 516   B01003_001    <span style="text-decoration: underline;">22</span>779    649.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> 516   B19013_001  1<span style="text-decoration: underline;">326</span>659 <span style="text-decoration: underline;">128</span>553.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> 525   B01003_001   <span style="text-decoration: underline;">109</span>992   <span style="text-decoration: underline;">1</span>607.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> 525   B19013_001  2<span style="text-decoration: underline;">965</span>635 <span style="text-decoration: underline;">153</span>947.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> 526   B01003_001   <span style="text-decoration: underline;">101</span>629   <span style="text-decoration: underline;">1</span>496.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> 526   B19013_001  2<span style="text-decoration: underline;">187</span>815 <span style="text-decoration: underline;">116</span>391.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> 620   B01003_001   <span style="text-decoration: underline;">296</span>331   <span style="text-decoration: underline;">2</span>842.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> 620   B19013_001  4<span style="text-decoration: underline;">623</span>927 <span style="text-decoration: underline;">163</span>752.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 52 more rows</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># aggregate multiple variables, outputting wide data</span></span></span>
<span class="r-in"><span><span class="fu">zi_aggregate</span><span class="op">(</span><span class="va">mo22_demos</span>, year <span class="op">=</span> <span class="fl">2020</span>,</span></span>
<span class="r-in"><span>  extensive <span class="op">=</span> <span class="st">"B01003_001"</span>, intensive <span class="op">=</span> <span class="st">"B19013_001"</span>, survey <span class="op">=</span> <span class="st">"acs5"</span>,</span></span>
<span class="r-in"><span>  zcta <span class="op">=</span> <span class="va">mo22_zcta3</span><span class="op">$</span><span class="va">ZCTA3</span>, output <span class="op">=</span> <span class="st">"wide"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #00BBBB;">•</span> You have not set a Census API key. Users without a key are limited to 500</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> queries per day and may experience performance limitations.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">ℹ</span> For best results, get a Census API key at</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> http://api.census.gov/data/key_signup.html and then supply the key to the</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> `census_api_key()` function to use it throughout your tidycensus session.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #555555;">This warning is displayed once per session.</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 31 × 5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># Groups:   ZCTA3 [31]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    ZCTA3 B01003_001E B01003_001M B19013_001E B19013_001M</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> 501        <span style="text-decoration: underline;">190</span>606       <span style="text-decoration: underline;">1</span>928.      <span style="text-decoration: underline;">74</span>666.      <span style="text-decoration: underline;">19</span>684.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> 516         <span style="text-decoration: underline;">22</span>779        649.      <span style="text-decoration: underline;">69</span>824.      <span style="text-decoration: underline;">21</span>896.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> 525        <span style="text-decoration: underline;">109</span>992       <span style="text-decoration: underline;">1</span>607.      <span style="text-decoration: underline;">63</span>099.      <span style="text-decoration: underline;">17</span>528.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> 526        <span style="text-decoration: underline;">101</span>629       <span style="text-decoration: underline;">1</span>496.      <span style="text-decoration: underline;">70</span>575.      <span style="text-decoration: underline;">16</span>179.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> 620        <span style="text-decoration: underline;">296</span>331       <span style="text-decoration: underline;">2</span>842.      <span style="text-decoration: underline;">66</span>056.      <span style="text-decoration: underline;">16</span>494.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> 630        <span style="text-decoration: underline;">736</span>536       <span style="text-decoration: underline;">7</span>216.      <span style="text-decoration: underline;">84</span>735.      <span style="text-decoration: underline;">12</span>280.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> 631        <span style="text-decoration: underline;">901</span>642       <span style="text-decoration: underline;">8</span>313.      <span style="text-decoration: underline;">69</span>807.       <span style="text-decoration: underline;">9</span>031 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> 633        <span style="text-decoration: underline;">536</span>266       <span style="text-decoration: underline;">5</span>361.      <span style="text-decoration: underline;">78</span>343.      <span style="text-decoration: underline;">16</span>652 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> 634         <span style="text-decoration: underline;">67</span>129       <span style="text-decoration: underline;">1</span>583.      <span style="text-decoration: underline;">60</span>690.      <span style="text-decoration: underline;">21</span>671.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> 635         <span style="text-decoration: underline;">60</span>410       <span style="text-decoration: underline;">1</span>185.      <span style="text-decoration: underline;">54</span>968.      <span style="text-decoration: underline;">17</span>621.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 21 more rows</span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Christopher Prener, Timothy Wiemken, Angela Cook.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

